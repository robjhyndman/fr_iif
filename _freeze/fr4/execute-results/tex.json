{
  "hash": "d6d23a6949192ba4151d855bbae97b8f",
  "result": {
    "markdown": "---\ntitle: Forecast reconciliation\nsubtitle: 4. Temporal & cross-temporal forecast reconciliation\nauthor: Rob J Hyndman\npdf-engine: latexmk\nfig-width: 9\nfig-height: 4.5\nformat:\n  beamer:\n    theme: monash\n    aspectratio: 169\n    fontsize: 14pt\n    section-titles: false\n    knitr:\n      opts_chunk:\n        dev: \"CairoPDF\"\ninclude-in-header: header.tex\ncite-method: biblatex\nbibliography: hts.bib\nbiblio-title: References\nkeep-tex: true\nhighlight-style: tango\nexecute:\n  echo: false\n  message: false\n  warning: false\n  cache: true\n---\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-1_32f6537348dfbc0e7aeaa9ca604acec2'}\n\n:::\n\n\n## Notation reminder\n\n\\begin{textblock}{8.5}(0.3,1.4)\nEvery collection of time series with linear constraints can be written as\n\\centerline{\\colorbox[RGB]{210,210,210}{$\\bY_{t}=\\color{blue}\\bS\\color{red}\\bm{b}_{t}$}}\n\\vspace*{-0.9cm}\\begin{itemize}\\parskip=0cm\\itemsep=0cm\n  \\item $\\by_t=$ vector of all series at time $t$\n  \\item $ y_{\\text{Total},t}= $ aggregate of all series at time\n        $t$.\n  \\item $ y_{X,t}= $ value of series $X$ at time $t$.\n  \\item $\\color{red}{\\bm{b}_t}=$ vector of most disaggregated series at time $t$\n  \\item $\\color{blue}{\\bS}=$ ``summing matrix'' containing the linear constraints.\n\\end{itemize}\n\\end{textblock}\n\n\\begin{textblock}{5.7}(11.2,0.3)\n\\begin{minipage}{4cm}\n  \\begin{block}{}\\centering\n    \\begin{tikzpicture}\n      \\tikzstyle{every node}=[ellipse,draw,fill=red!15,inner sep=2pt]\n      \\tikzstyle[level distance=.3cm]\n      \\tikzstyle[sibling distance=12cm]\n      \\tikzstyle{level 1}=[sibling distance=10mm,font=\\small,set style={{every node}+=[fill=blue!15]}]\n      \\node{Total}[edge from parent fork down]\n      child {node {A}\n        }\n      child {node {B}\n        }\n      child {node {C}\n        };\n    \\end{tikzpicture}\n  \\end{block}\n\\end{minipage}\n\\end{textblock}\n\n\\only<1>{\\begin{textblock}{5.7}(9.2,2.8)\\fontsize{14}{15}\\sf\n  \\begin{align*}\n    \\bY_{t} & = \\begin{pmatrix}\n                  y_{\\text{Total},t} \\\\\n                  y_{A,t}            \\\\\n                  y_{B,t}            \\\\\n                  y_{C,t}\n                \\end{pmatrix}                             \\\\\n            & = {\\color{blue}\\underbrace{\\begin{pmatrix}\n                                              1 & 1 & 1 \\\\\n                                              1 & 0 & 0 \\\\\n                                              0 & 1 & 0 \\\\\n                                              0 & 0 & 1\n                                            \\end{pmatrix}}_{\\bS}}\n    {\\color{red}\\underbrace{\\begin{pmatrix}\n                                y_{A,t} \\\\y_{B,t}\\\\y_{C,t}\n                              \\end{pmatrix}}_{\\bm{b}_{t}}}\n  \\end{align*}\n\\end{textblock}}\n\\only<2>{\\begin{textblock}{5.7}(9.2,3.3)\\fontsize{14}{15}\\sf\n  \\begin{alertblock}{}\n    \\begin{itemize}\\itemsep=0.1cm\n      \\item Base forecasts: $\\hat{\\bm{y}}_{T+h|T}$\n      \\item Reconciled forecasts: $\\tilde{\\bm{y}}_{T+h|T}=\\bS\\bm{G}\\hat{\\bm{y}}_{T+h|T}$\n      \\item MinT: $\\bG = (\\bS'\\bm{W}_h^{-1}\\bS)^{-1}\\bS'\\bm{W}_h^{-1}$ where $\\bm{W}_h$ is covariance matrix of base forecast errors.\n    \\end{itemize}\n  \\end{alertblock}\n\\end{textblock}}\n\n# Temporal reconciliation\n\n## Temporal reconciliation: quarterly data\n\n\\begin{textblock}{7}(1,1.9)\n\\begin{tikzpicture}\n  \\tikzstyle{every node}=[ellipse,draw,inner sep=0.2pt,fill=red!15,font=\\small]\n  \\tikzstyle[level distance=.1cm]\n  \\tikzstyle[sibling distance=3cm]\n  \\tikzstyle{level 1}=[sibling distance=18mm,set style={{every node}+=[fill=yellow]}]\n  \\node{Annual}[edge from parent fork down]\n  child {node {Q$_1$}}\n  child {node {Q$_2$}}\n  child {node {Q$_3$}}\n  child {node {Q$_4$}};\n\\end{tikzpicture}\n\\end{textblock}\n\n\\only<3>{\\begin{textblock}{8.5}(8.3,1.1)\\fontsize{14}{17}\\sf\n$$\\bm{y}_\\tau =\n  \\begin{bmatrix}\n    x_{\\tau}^{[4]}  \\\\[0.2cm]\n    x_{\\tau,1}^{[1]} \\\\[0.2cm]\n    x_{\\tau,2}^{[1]} \\\\[0.2cm]\n    x_{\\tau,3}^{[1]} \\\\[0.2cm]\n    x_{\\tau,4}^{[1]}\n  \\end{bmatrix}\n  \\qquad\n  \\bm{S} = \\begin{bmatrix}\n    1 & 1 & 1 & 1 \\\\[0.2cm]\n    1 & 0 & 0 & 0 \\\\[0.2cm]\n    0 & 1 & 0 & 0 \\\\[0.2cm]\n    0 & 0 & 1 & 0 \\\\[0.2cm]\n    0 & 0 & 0 & 1\n  \\end{bmatrix}\n$$\n\\end{textblock}}\n\n\\only<2->{\\begin{textblock}{8}(.3,5.7)\n  \\begin{alertblock}{}\n    \\begin{itemize}\n      \\item[\\color{white}\\ding{229}] Forecast series at each available frequency.\n      \\item[\\color{white}\\ding{229}] Optimally combine forecasts within the same year.\n    \\end{itemize}\n  \\end{alertblock}\n\\end{textblock}}\n\n\\only<3->{\\begin{textblock}{5}(10.3,7.9)\n\\fontsize{11}{12}\\sf\n$\\tau=$ index of largest temporal aggregation level.\n\\end{textblock}}\n\n\n## Temporal reconciliation: quarterly data\n\n\\begin{textblock}{7}(0.1,1.9)\n\\begin{tikzpicture}\n  \\tikzstyle{every node}=[ellipse,draw,inner sep=0.2pt,fill=red!15,font=\\small]\n  \\tikzstyle[level distance=.1cm]\n  \\tikzstyle[sibling distance=3cm]\n  \\tikzstyle{level 1}=[sibling distance=42mm,set style={{every node}+=[fill=blue!15]}]\n  \\tikzstyle{level 2}=[sibling distance=18mm,set style={{every node}+=[fill=yellow]}]\n  \\node{Annual}[edge from parent fork down]\n  child {node {Semi-Annual$_1$}\n      child {node {Q$_1$}}\n      child {node {Q$_2$}}\n    }\n  child {node {Semi-Annual$_2$}\n      child {node {Q$_3$}}\n      child {node {Q$_4$}}\n    };\n\\end{tikzpicture}\n\\end{textblock}\n\n\\begin{textblock}{8.5}(8.3,1.1)\\fontsize{14}{17}\\sf\n$$\\bm{y}_\\tau =\n  \\begin{bmatrix}\n    x_{\\tau}^{[4]}  \\\\[0.2cm]\n    x_{\\tau,1}^{[2]} \\\\[0.2cm]\n    x_{\\tau,2}^{[2]} \\\\[0.2cm]\n    x_{\\tau,1}^{[1]} \\\\[0.2cm]\n    x_{\\tau,2}^{[1]} \\\\[0.2cm]\n    x_{\\tau,3}^{[1]} \\\\[0.2cm]\n    x_{\\tau,4}^{[1]}\n  \\end{bmatrix}\n  \\qquad\n  \\bm{S} = \\begin{bmatrix}\n    1 & 1 & 1 & 1 \\\\[0.2cm]\n    1 & 1 & 0 & 0 \\\\[0.2cm]\n    0 & 0 & 1 & 1 \\\\[0.2cm]\n    1 & 0 & 0 & 0 \\\\[0.2cm]\n    0 & 1 & 0 & 0 \\\\[0.2cm]\n    0 & 0 & 1 & 0 \\\\[0.2cm]\n    0 & 0 & 0 & 1\n  \\end{bmatrix}\n$$\n\\end{textblock}\n\n\\begin{textblock}{8}(.3,5.7)\n  \\begin{alertblock}{}\n    \\begin{itemize}\n      \\item[\\color{white}\\ding{229}] Forecast series at each available frequency.\n      \\item[\\color{white}\\ding{229}] Optimally combine forecasts within the same year.\n    \\end{itemize}\n  \\end{alertblock}\n\\end{textblock}\n\n\\begin{textblock}{5}(10.3,7.9)\n\\fontsize{11}{12}\\sf\n$\\tau=$ index of largest temporal aggregation level.\n\\end{textblock}\n\n## Temporal reconciliation: monthly data\n\n\\only<1>{\\begin{tikzpicture}\n  \\tikzstyle{every node}=[ellipse,draw,inner sep=0.2pt,fill=red!15,font=\\small]\n  \\tikzstyle[level distance=.1cm]\n  \\tikzstyle[sibling distance=7cm]\n  \\tikzstyle{level 1}=[sibling distance=72mm,set style={{every node}+=[fill=blue!15]}]\n  \\tikzstyle{level 2}=[sibling distance=36mm,set style={{every node}+=[fill=yellow]}]\n  \\tikzstyle{level 3}=[sibling distance=12mm,font=\\scriptsize,set style={{every node}+=[fill=green]}]\n  \\node{Annual}[edge from parent fork down]\n  child {node {Semi-Annual$_1$}\n      child {node {Q$_1$}\n          child {node {\\scriptsize M$_1$}}\n          child {node {\\scriptsize M$_2$}}\n          child {node {\\scriptsize M$_3$}}\n        }\n      child {node {Q$_2$}\n          child {node {\\scriptsize M$_4$}}\n          child {node {\\scriptsize M$_5$}}\n          child {node {\\scriptsize M$_6$}}\n        }\n    }\n  child {node {Semi-Annual$_2$}\n      child {node {Q$_3$}\n          child {node {\\scriptsize M$_7$}}\n          child {node {\\scriptsize M$_8$}}\n          child {node {\\scriptsize M$_9$}}\n        }\n      child {node {Q$_4$}\n          child {node {\\scriptsize M$_{10}$}}\n          child {node {\\scriptsize M$_{11}$}}\n          child {node {\\scriptsize M$_{12}$}}\n        }\n    };\n\\end{tikzpicture}}\n\\only<2->{\\begin{tikzpicture}\n  \\tikzstyle{every node}=[ellipse,draw,inner sep=0.2pt,fill=red!15,font=\\small]\n  \\tikzstyle[level distance=.1cm]\n  \\tikzstyle[sibling distance=7cm]\n  \\tikzstyle{level 1}=[sibling distance=48mm,set style={{every node}+=[fill=blue!15]}]\n  \\tikzstyle{level 2}=[sibling distance=24mm,set style={{every node}+=[fill=yellow]}]\n  \\tikzstyle{level 3}=[sibling distance=12mm,set style={{every node}+=[fill=green]}]\n  \\node{Annual}[edge from parent fork down]\n  child {node {FourM$_1$}\n      child {node {BiM$_1$}\n          child {node {\\scriptsize M$_1$}}\n          child {node {\\scriptsize M$_2$}}\n        }\n      child {node {BiM$_2$}\n          child {node {\\scriptsize M$_3$}}\n          child {node {\\scriptsize M$_4$}}\n        }\n    }\n  child {node {FourM$_2$}\n      child {node {BiM$_3$}\n          child {node {\\scriptsize M$_5$}}\n          child {node {\\scriptsize M$_6$}}\n        }\n      child {node {BiM$_4$}\n          child {node {\\scriptsize M$_7$}}\n          child {node {\\scriptsize M$_8$}}\n        }\n    }\n  child {node {FourM$_3$}\n      child {node {BiM$_5$}\n          child {node {\\scriptsize M$_9$}}\n          child {node {\\scriptsize M$_{10}$}}\n        }\n      child {node {BiM$_6$}\n          child {node {\\scriptsize M$_{11}$}}\n          child {node {\\scriptsize M$_{12}$}}\n        }\n    };\n\\end{tikzpicture}}\\pause\n\n\\begin{textblock}{14}(1,6.7)\n  \\begin{alertblock}{}\n    \\begin{itemize}\n      \\item[\\color{white}\\ding{229}] Forecast series at each available frequency.\n      \\item[\\color{white}\\ding{229}] Optimally combine forecasts within the same year.\n    \\end{itemize}\n  \\end{alertblock}\n\\end{textblock}\n\n## Temporal reconciliation: monthly data\n\\fontsize{11}{11}\\sf\n\n$$\n  \\bm{y}_\\tau=\\begin{bmatrix}\n    x_{\\tau}^{[12]}     \\\\[0.2cm]\n    \\bm{x}_{\\tau}^{[6]} \\\\[0.2cm]\n    \\bm{x}_{\\tau}^{[4]} \\\\[0.2cm]\n    \\bm{x}_{\\tau}^{[3]} \\\\[0.2cm]\n    \\bm{x}_\\tau^{[2]}   \\\\[0.2cm]\n    \\bm{x}_\\tau^{[1]}\n  \\end{bmatrix}\n  \\qquad\n  \\bm{S} = \\begin{bmatrix}\n    1                & 1 & 1 & 1 & 1~~~1~~~1~~~1 & 1 & 1 & 1 & 1 \\\\\n    1                & 1 & 1 & 1 & 1~~~1~~~0~~~0 & 0 & 0 & 0 & 0 \\\\\n    0                & 0 & 0 & 0 & 0~~~0~~~1~~~1 & 1 & 1 & 1 & 1 \\\\\n    1                & 1 & 1 & 1 & 0~~~0~~~0~~~0 & 0 & 0 & 0 & 0 \\\\\n    0                & 0 & 0 & 0 & 1~~~1~~~1~~~1 & 0 & 0 & 0 & 0 \\\\\n    0                & 0 & 0 & 0 & 0~~~0~~~0~~~0 & 1 & 1 & 1 & 1 \\\\\n    1                & 1 & 1 & 0 & 0~~~0~~~0~~~0 & 0 & 0 & 0 & 0 \\\\\n                     &   &   &   & \\vdots        &   &   &   &   \\\\\n    0                & 0 & 0 & 0 & 0~~~0~~~0~~~0 & 0 & 1 & 1 & 1 \\\\\n    1                & 1 & 0 & 0 & 0~~~0~~~0~~~0 & 0 & 0 & 0 & 0 \\\\\n                     &   &   &   & \\vdots        &   &   &   &   \\\\\n    0                & 0 & 0 & 0 & 0~~~0~~~0~~~0 & 0 & 0 & 1 & 1 \\\\[0.2cm]\n    \\phantom{\\vdots} &   &   &   & \\bm{I}_{12}   &   &   &   &\n  \\end{bmatrix}\n$$\n\n## Temporal reconciliation\n\\fontsize{14}{15}\\sf\n\nFor a time series  $y_1,\\dots,y_T$, observed at frequency $m$:\n\\begin{alertblock}{}\\vspace*{-0.1cm}\n$$\n  x_j^{[k]} = \\sum_{t = (j-1)k+1}^{jk} y_t\\qquad \\text{for $j = 1,\\dots,\\lfloor T/k\\rfloor$}\n$$\n\\end{alertblock}\n* $k \\in \\mathcal{K} = \\{k_1,\\dots,k_p\\}$ denote the $p$ factors of $m$ in ascending order, where $k_1=1$ and $k_p=m$\n* $x_j^{[1]} = y_t$\n* A single unique hierarchy is only possible when there are no coprime pairs in $\\mathcal{K}$.\n* $M_k=m/k$ is seasonal period of aggregated series.\n\n## Temporal reconciliation\n\\fontsize{14}{15}\\sf\\vspace*{-0.5cm}\n$$\\bm{x}_\\tau = \\bm{S} \\bm{x}_\\tau^{[1]}, \\qquad \\bm{S} = \\begin{bmatrix}\\bm{A}\\\\\\bm{I}\\end{bmatrix}$$\nwhere\n$$\n\\bm{x}_\\tau = \\begin{bmatrix*}[l]\n    {x_\\tau^{[k_p]}}\\\\\n    {\\bm{x}_\\tau^{[k_{p-1}]}}\\\\\n    \\quad\\vdots\\\\\n    {\\bm{x}_\\tau^{[k_1]}}\\\\\n  \\end{bmatrix*}\\qquad\n  \\bm{x}_\\tau^{[k]} = \\begin{bmatrix*}[l]\n    x_{M_k(\\tau-1)+1}^{[k]}\\\\\n    x_{M_k(\\tau-1)+2}^{[k]}\\\\\n    \\quad\\vdots\\\\\n    x_{M_k\\tau}^{[k]}\n  \\end{bmatrix*}\\qquad\n\\bm{A} =\n  \\begin{bmatrix}\n    \\bm{1}'_m                                    \\\\\n    \\bm{I}_{m/k_{p-1}} \\otimes \\bm{1}'_{k_{p-1}} \\\\\n    \\vdots                                       \\\\\n    \\bm{I}_{m/k_{2}} \\otimes \\bm{1}'_{k_{2}}     \\\\\n  \\end{bmatrix}\n$$\n$\\tau$ is time index for most aggregated series,\n\n$k\\in \\mathcal{K} = \\{k_1,\\dots,k_p\\}$,\\quad $k_1=1$,\\quad $k_p=m$,\\quad $\\tau=1,\\dots,T/m$.\n\n# Temporal reconciliation: thief package\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{9.5}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-2_4b8f9278f68a3f81c03dfbe9e726c6d8'}\n\n```{.r .cell-code}\nlibrary(thief)\nUSAccDeaths\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov   Dec\n1973  9007  8106  8928  9137 10017 10826 11317 10744  9713  9938  9161  8927\n1974  7750  6981  8038  8422  8714  9512 10120  9823  8743  9129  8710  8680\n1975  8162  7306  8124  7870  9387  9556 10093  9620  8285  8466  8160  8034\n1976  7717  7461  7767  7925  8623  8945 10078  9179  8037  8488  7874  8647\n1977  7792  6957  7726  8106  8890  9299 10625  9302  8314  8850  8265  8796\n1978  7836  6892  7791  8192  9115  9434 10484  9827  9110  9070  8633  9240\n```\n:::\n\n```{.r .cell-code}\nthief(USAccDeaths, usemodel = \"arima\", comb = \"struc\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Jan       Feb       Mar       Apr       May       Jun       Jul\n1979  8185.240  7381.008  8131.674  8516.070  9393.247  9764.091 10880.835\n1980  8405.850  7601.618  8352.284  8736.680  9613.857  9984.701 11101.445\n           Aug       Sep       Oct       Nov       Dec\n1979 10059.873  9182.403  9405.069  8869.173  9360.772\n1980 10280.483  9403.013  9625.679  9089.783  9581.382\n```\n:::\n:::\n\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-3_a0869868faa31d9cb19f89b2060310c6'}\n\n```{.r .cell-code}\n# Construct aggregates\naggts <- tsaggregates(USAccDeaths)\naggts[[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov   Dec\n1973  9007  8106  8928  9137 10017 10826 11317 10744  9713  9938  9161  8927\n1974  7750  6981  8038  8422  8714  9512 10120  9823  8743  9129  8710  8680\n1975  8162  7306  8124  7870  9387  9556 10093  9620  8285  8466  8160  8034\n1976  7717  7461  7767  7925  8623  8945 10078  9179  8037  8488  7874  8647\n1977  7792  6957  7726  8106  8890  9299 10625  9302  8314  8850  8265  8796\n1978  7836  6892  7791  8192  9115  9434 10484  9827  9110  9070  8633  9240\n```\n:::\n:::\n\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-4_713a2c1e51e6df80a386de011311fd39'}\n\n```{.r .cell-code}\naggts[[2]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTime Series:\nStart = c(1973, 1) \nEnd = c(1978, 6) \nFrequency = 6 \n [1] 17113 18065 20843 22061 19651 18088 14731 16460 18226 19943 17872 17390\n[13] 15468 15994 18943 19713 16751 16194 15178 15692 17568 19257 16525 16521\n[25] 14749 15832 18189 19927 17164 17061 14728 15983 18549 20311 18180 17873\n```\n:::\n:::\n\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-5_1234613b23889c0bd3b058b7fed1c273'}\n\n```{.r .cell-code}\naggts[[3]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Qtr1  Qtr2  Qtr3  Qtr4\n1973 26041 29980 31774 28026\n1974 22769 26648 28686 26519\n1975 23592 26813 27998 24660\n1976 22945 25493 27294 25009\n1977 22475 26295 28241 25911\n1978 22519 26741 29421 26943\n```\n:::\n:::\n\n\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-6_b67f0942084a6d36a3d701b167a3bd54'}\n\n```{.r .cell-code}\naggts[[4]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTime Series:\nStart = c(1973, 1) \nEnd = c(1978, 3) \nFrequency = 3 \n [1] 35178 42904 37739 31191 38169 35262 31462 38656 32945 30870 36825 33046\n[13] 30581 38116 34225 30711 38860 36053\n```\n:::\n:::\n\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-7_62142d5f03001c17c9f05d7b87ae09d0'}\n\n```{.r .cell-code}\naggts[[5]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTime Series:\nStart = c(1973, 1) \nEnd = c(1978, 2) \nFrequency = 2 \n [1] 56021 59800 49417 55205 50405 52658 48438 52303 48770 54152 49260 56364\n```\n:::\n:::\n\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-8_faa64283dc06682c1e5bdd95eb766204'}\n\n```{.r .cell-code}\naggts[[6]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTime Series:\nStart = 1973 \nEnd = 1978 \nFrequency = 1 \n[1] 115821 104622 103063 100741 102922 105624\n```\n:::\n:::\n\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-9_d70e0f1c99ae57a7c229f18c163d0513'}\n\n```{.r .cell-code}\n# Compute forecasts\nfc <- list()\nfor(i in seq_along(aggts)) {\n  fc[[i]] <- forecast(auto.arima(aggts[[i]]), h=2*frequency(aggts[[i]]))\n}\nreconciled <- reconcilethief(fc)\nreconciled[[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         Point Forecast     Lo 80     Hi 80    Lo 95     Hi 95\nJan 1979       8185.240  7773.891  8596.589 7556.136  8814.344\nFeb 1979       7381.008  6907.643  7854.373 6657.059  8104.957\nMar 1979       8131.674  7603.525  8659.822 7323.941  8939.407\nApr 1979       8516.070  7938.310  9093.830 7632.462  9399.678\nMay 1979       9393.247  8769.810 10016.683 8439.783 10346.710\nJun 1979       9764.091  9098.104 10430.079 8745.552 10782.631\nJul 1979      10880.835 10174.856 11586.813 9801.134 11960.535\nAug 1979      10059.873  9316.050 10803.695 8922.295 11197.451\nSep 1979       9182.403  8402.572  9962.235 7989.754 10375.053\nOct 1979       9405.069  8590.819 10219.320 8159.780 10650.358\nNov 1979       8869.173  8021.900  9716.445 7573.382 10164.964\nDec 1979       9360.772  8481.718 10239.827 8016.375 10705.170\nJan 1980       8405.850  7432.138  9379.562 6916.686  9895.015\nFeb 1980       7601.618  6570.572  8632.664 6024.769  9178.467\nMar 1980       8352.284  7266.928  9437.639 6692.376 10012.192\nApr 1980       8736.680  7599.606  9873.754 6997.675 10475.685\nMay 1980       9613.857  8427.316 10800.397 7799.200 11428.513\nJun 1980       9984.701  8750.676 11218.727 8097.423 11871.980\nJul 1980      11101.445  9821.695 12381.194 9144.236 13058.653\nAug 1980      10280.483  8956.587 11604.378 8255.759 12305.206\nSep 1980       9403.013  8036.397 10769.630 7312.954 11493.073\nOct 1980       9625.679  8217.638 11033.721 7472.266 11779.093\nNov 1980       9089.783  7641.500 10538.065 6874.826 11304.739\nDec 1980       9581.382  8093.948 11068.817 7306.547 11856.217\n```\n:::\n:::\n\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-10_e4a70dfab11409e275ca8a14296b4090'}\n\n```{.r .cell-code}\nreconciled[[2]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95\n1979.000       15566.25 14788.53 16343.97 14376.83 16755.67\n1979.167       16647.74 15634.48 17661.00 15098.10 18197.39\n1979.333       19157.34 17953.79 20360.89 17316.66 20998.01\n1979.500       20940.71 19573.09 22308.33 18849.11 23032.30\n1979.667       18587.47 17073.46 20101.48 16271.99 20902.95\n1979.833       18229.94 16582.50 19877.39 15710.40 20749.49\n1980.000       16007.47 14159.37 17855.57 13181.05 18833.89\n1980.167       17088.96 15077.40 19100.53 14012.54 20165.39\n1980.333       19598.56 17435.85 21761.27 16290.98 22906.14\n1980.500       21381.93 19077.96 23685.89 17858.32 24905.53\n1980.667       19028.69 16591.65 21465.73 15301.56 22755.83\n1980.833       18671.16 16107.94 21234.39 14751.06 22591.27\n```\n:::\n:::\n\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-11_52760ffc20189d91a43fb129ebf210fc'}\n\n```{.r .cell-code}\nreconciled[[3]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95\n1979 Q1       23697.92 22460.67 24935.17 21805.71 25590.13\n1979 Q2       27673.41 25923.67 29423.15 24997.41 30349.40\n1979 Q3       30123.11 27980.13 32266.09 26845.70 33400.52\n1979 Q4       27635.01 25160.51 30109.52 23850.59 31419.44\n1980 Q1       24359.75 20860.28 27859.23 19007.77 29711.74\n1980 Q2       28335.24 24049.27 32621.20 21780.42 34890.06\n1980 Q3       30784.94 25835.93 35733.95 23216.09 38353.79\n1980 Q4       28296.84 22763.69 33830.00 19834.61 36759.08\n```\n:::\n:::\n\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-12_d6e0f077d75c733c8d6172b82784ca05'}\n\n```{.r .cell-code}\nreconciled[[4]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95\n1979.000       32213.99 30196.88 34231.11 29129.08 35298.90\n1979.333       40098.05 37245.41 42950.68 35735.32 44460.77\n1979.667       36817.42 33323.67 40311.16 31474.19 42160.64\n1980.000       33096.43 27759.64 38433.22 24934.52 41258.34\n1980.333       40980.49 34290.47 47670.50 30748.99 51211.98\n1980.667       37699.86 29887.60 45512.11 25752.04 49647.67\n```\n:::\n:::\n\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-13_2b7c4e0df2ce8e49697b6555b82072c6'}\n\n```{.r .cell-code}\nreconciled[[5]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95\n1979.00       51371.33 48111.38 54631.28 46385.66 56357.00\n1979.50       57758.12 53147.85 62368.40 50707.32 64808.93\n1980.00       52694.99 44709.77 60680.21 40482.64 64907.33\n1980.50       59081.78 48772.91 69390.66 43315.72 74847.85\n```\n:::\n:::\n\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-14_651fe4a9ff6bb160a86f8ef5e73ef0ec'}\n\n```{.r .cell-code}\nreconciled[[6]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Point Forecast    Lo 80    Hi 80     Lo 95    Hi 95\n1979       109129.5 102287.0 115971.9  98664.81 119594.1\n1980       111776.8 104934.3 118619.2 101312.13 122241.4\n```\n:::\n:::\n\n\n## Temporal reconciliation: thief package\n\\fontsize{10}{11}\\sf\n\n\n::: {.cell hash='fr4_cache/beamer/unnamed-chunk-15_0e924a3e8fae15822976936dba4e9121'}\n::: {.cell-output-display}\n![](fr4_files/figure-beamer/unnamed-chunk-15-1.pdf)\n:::\n:::\n\n\n# Temporal reconciliation: Examples\n\n## Temporal reconciliation: M3 monthly series\n\n* Apply temporal reconciliation to all 1428 monthly series from M3 competition\n* Forecast horizon $h=18$ months\n* ETS and ARIMA models\n* Measure percentage difference to base forecasts\n* Reconciliation methods:\n  * WLS$_H$ (diagonal)\n  * WLS$_V$ (diagonal with common variances for same frequency)\n  * WLS$_S$ (diagonal/structural)\n\n## Temporal reconciliation: M3 monthly series\n\\fontsize{9}{9}\\sf\n\\tabcolsep=0.15cm\n\\centering\n\\begin{tabular}{lr@{\\hskip 0.2cm}rrrrrrrr@{\\hskip 0.2cm}rrrrrr}\nAggregation & & & \\multicolumn{6}{c}{ETS} & & \\multicolumn{5}{c}{ARIMA} \\\\\n\\cmidrule{4-9}\\cmidrule{11-16}\nlevel & $h$ & & Base & & BU & WLS$_H$ & WLS$_V$ & WLS$_S$ & & Base & & BU & WLS$_H$ & WLS$_V$ & WLS$_S$\\\\\n\\midrule\n & & & \\multicolumn{13}{c}{RMAE}\\\\[0.05cm]\nAnnual           & 1  & & 1.0 & & -19.6 &      -22.0 &      -22.0 & {\\bf-25.1}      & & 1.0 & &  -28.6 &      -33.1 &      -32.8 &    {\\bf -33.4} \\\\\nSemi-annual      & 3  & & 1.0 & &   0.6 &       -4.0 &       -3.6 & {\\bf -5.4}      & & 1.0 & &   -3.4 &       -8.2 &       -8.3 &   {\\bf  -9.9} \\\\\nFour-monthly     & 4  & & 1.0 & &   2.0 &       -2.4 &       -2.2 & {\\bf -3.0}      & & 1.0 & &   -1.7 &       -5.5 &       -5.9 &   {\\bf  -6.7} \\\\\nQuarterly        & 6  & & 1.0 & &   2.4 &       -1.6 &       -1.7 & {\\bf -2.8}      & & 1.0 & &   -3.6 &       -7.2 &       -8.1 &   {\\bf  -9.1} \\\\\nBi-monthly       & 9  & & 1.0 & &   0.7 &       -2.9 &       -3.3 & {\\bf -4.3}      & & 1.0 & &   -1.5 &       -4.4 &       -5.3 &   {\\bf  -6.3} \\\\\nMonthly          & 18 & & 1.0 & &   0.0 &       -2.2 &       -3.2 & {\\bf -3.9}      & & 1.0 & &    0.0 &       -0.9 &       -2.9 &   {\\bf  -3.4}  \\\\[0.01cm]\n\\textit{Average} &    & &   & & \\textit{-2.3} & \\textit{-5.9} & \\textit{-6.0} & {\\bf\\textit{-7.4}} & &      & & \\textit{-6.5} & \\textit{-9.9} & \\textit{-10.5} & {\\bf\\textit{ -11.5}} \\\\[0.1cm]\n & & & \\multicolumn{13}{c}{MASE}\\\\[0.05cm]\nAnnual           & 1  & &  1.1  & &     -12.1 &      -17.9 &   -17.8 &  {\\bf -18.5}  & &       1.3 & &     -25.4 &      -29.9 &      -29.9 &  {\\bf -30.2}\\\\\nSemi-annual      & 3  & &  1.0  & &       0.0 &       -6.3 &    -6.0 &  {\\bf  -6.9}  & &       1.1 & &      -2.9 &       -8.1 &       -8.2 &  {\\bf  -9.4}\\\\\nFour-monthly     & 4  & &  0.9  & &       3.1 &       -3.2 &    -3.0 &  {\\bf  -3.4}  & &       0.9 & &      -1.8 &       -6.2 &       -6.5 &  {\\bf  -7.1}\\\\\nQuarterly        & 6  & &  0.9  & &       3.2 &       -2.8 &    -2.7 &  {\\bf  -3.4}  & &       1.0 & &      -2.6 &       -6.9 &       -7.4 &  {\\bf  -8.1}\\\\\nBi-monthly       & 9  & &  0.9  & &       2.7 &       -2.9 &    -3.0 &  {\\bf  -3.7}  & &       0.9 & &      -1.3 &       -5.0 &       -5.5 &  {\\bf  -6.3}\\\\\nMonthly          & 18 & &  0.9  & &       0.0 &       -3.7 &    -4.6 &  {\\bf  -5.0}  & &       0.9 & &       0.0 &       -1.9 &       -3.2 &  {\\bf  -3.7}\\\\ [0.01cm]\n\\textit{Average} &    & &       & & \\textit{-0.5} & \\textit{-6.1} & \\textit{-6.2} & {\\bf\\textit{-6.8}} & &      & & \\textit{-5.7} & \\textit{-9.7} & \\textit{-10.1} & {\\bf\\textit{ -10.8}}\n\\end{tabular}\n\n## Example: Accident & emergency services demand\n\nWeekly A\\&E demand data: 7 November 2010 to 7 June 2015.\\fontsize{11}{11.5}\\sf\n\n\\begin{tabular}{l}\n  \\toprule\n  Type 1 Departments --- Major A\\&E                               \\\\\n  Type 2 Departments --- Single Specialty                         \\\\\n  Type 3 Departments --- Other A\\&E/Minor Injury Unit             \\\\\n  Total Attendances                                               \\\\\n  Type 1 Departments --- Major A\\&E $>$ 2 hours                   \\\\\n  Type 2 Departments --- Single Specialty $>$ 2 hours             \\\\\n  Type 3 Departments --- Other A\\&E/Minor Injury Unit $>$ 2 hours \\\\\n  Total Attendances $>$ 2 hours                                   \\\\\n  Emergency Admissions via Type 1 A\\&E                            \\\\\n  Total Emergency Admissions via A\\&E                             \\\\\n  Other Emergency Admissions (i.e not via A\\&E)                   \\\\\n  Total Emergency Admissions                                      \\\\\n  Number of patients spending $>$ 2 hours from decision to admit to admission\n\\end{tabular}\n\n## Example: Accident & emergency services demand\n\n\\placefig{2.2}{2.2}{height=6.5cm, width=14cm}{AEexample.pdf}\n\n\\begin{textblock}{10}(3,1)\\fontsize{12}{12}\\sf\n  \\begin{block}{}\\centering\n    Total emergency admissions via A\\&E\n  \\end{block}\n\\end{textblock}\n\n## Example: Accident & emergency services demand\n\nTest set: last 52 weeks\n\n\\alert{MASE comparison} (ARIMA models)\n\n\\begin{tabular}{llllr}\n  \\toprule\n  Aggr. Level & $h$   & Base & Reconciled & Change  \\\\\n  \\midrule\n  Annual & 1       & 3.4   & 1.9   & $-42.9\\%$ \\\\\n  Weekly & 1--52   & 2.0   & 1.9   & $-5.0\\%$ \\\\\n  Weekly & 13      & 2.3   & 1.9   & $-16.2\\%$ \\\\\n  Weekly & 4       & 1.9   & 1.5   & $-18.6\\%$ \\\\\n  Weekly & 1       & 1.6   & 1.3   & $-17.2\\%$ \\\\\n\\end{tabular}\n\n# Cross-temporal forecast reconciliation\n\n## Cross-temporal forecast reconciliation\n\n\\begin{tikzpicture}[baseline=(current  bounding  box.center),\n  rel/.append style={shape=ellipse,\n    draw=black,\n  minimum width=1.5cm,\n  minimum height=1cm},\n  rel2/.append style={shape=rectangle,\n    draw=black,\n  minimum width=1.5cm,\n  minimum height=1cm},\n  connection/.style ={inner sep =0, outer sep =0}]\n\n  \\node[rel] at (0, 0) (X){$y_{X,t}$};\n  \\node[rel] at (2, 0) (Y){$y_{Y,t}$};\n  \\node[rel] at (1, 1.5) (Tt){$y_{T,t}$};\n\n  \\relation{0.2}{X}{Tt};\n  \\relation{0.2}{Y}{Tt};\n\n\n  \\node[rel2] at (5, 0) (AA){$y_{i,4\\tau-3}$};\n  \\node[rel2] at (7, 0) (AB){$y_{i,4\\tau-2}$};\n  \\node[rel2] at (9, 0) (BA){$y_{i,4\\tau-1}$};\n  \\node[rel2] at (11, 0) (BB){$y_{i,4\\tau}$};\n\n  \\node[rel2] at (6, 1.5) (A){$x_{i,2\\tau-1}^{[2]}$};\n  \\node[rel2] at (10, 1.5) (B){$x_{i,2\\tau}^{[2]}$};\n  \\node[rel2] at (8, 3) (T){$x_{i,\\tau}^{[4]}$};\n\n  \\relation{0.2}{AA}{A};\n  \\relation{0.2}{AB}{A};\n  \\relation{0.2}{BA}{B};\n  \\relation{0.2}{BB}{B};\n\n  \\relation{0.2}{A}{T};\n  \\relation{0.2}{B}{T};\n\\end{tikzpicture}\\vspace*{0.7cm}\n\n* $n=3$, $n_a = 1$, $n_b = 2$\n* Quarterly series: $m = 2$, $\\mathcal{K} = \\{1,2,4\\}$\n\n## Cross-temporal forecast reconciliation\n\n* $\\bm{y}_t=$ series at most temporally disaggregated level, including all cross-sectionally disaggregated and aggregated series.\n* $y_{i,t}=$ $i$th element of $\\bm{y}_t$, $i=1,\\dots,n$.\n* For each $i$, we can expand $y_{i,t}$ to include all temporally aggregated variants:\n$$\\bm{x}_{i,\\tau} = \\begin{bmatrix}\n    {x_{i,\\tau}^{[k_p]}} \\\\\n    \\vdots               \\\\\n    {\\bm{x}_{i,\\tau}^{[k_1]}}\n  \\end{bmatrix}\\qquad\n\\bm{x}_\\tau = \\begin{bmatrix}\n    \\bm{x}_{1,\\tau} \\\\\n    \\vdots          \\\\\n    \\bm{x}_{n,\\tau}\n  \\end{bmatrix}.$$\n\n## Cross-temporal forecast reconciliation\n\n\\alert{Structural matrix approach}\n\n* $\\bm{S}_{cs}=$ structural cross-sectional matrix\n* $\\bm{S}_{te}=$ structural temporal matrix\n* $\\bm{S}_{ct} = \\bm{S}_{cs} \\otimes \\bm{S}_{te}$\n\n\\vspace*{-0.6cm}\n\n$$\\bm{x}_\\tau = \\bm{S}_{ct} \\bm{b}_\\tau,\\qquad\\text{where}\\qquad\n\\bm{b}_\\tau = \\begin{bmatrix}\n    {\\bm{x}_{1,\\tau}^{[1]}} \\\\\n    \\vdots                  \\\\\n    {\\bm{x}_{n,\\tau}^{[1]}}\n  \\end{bmatrix}.\n$$\n\n## Cross-temporal forecast reconciliation\n\n\\full{Smatrix}\n\n\\begin{textblock}{5}(0.5,1.5)\n\\begin{block}{}\n\\centerline{$\\bm{S}_{cs} \\otimes \\bm{S}_{te} = \\bm{S}_{ct}$}\n\\end{block}\n\\end{textblock}\n\n## Cross-temporal forecast reconciliation\n\n\\alert{Constraint matrix approach}\n\n* $\\bm{C}_{cs}=$ cross-sectional constraint matrix\n* $\\bm{C}_{te}=$ temporal constraint matrix\n\n\\vspace*{-0.6cm}\n\n$$\\bm{C}_{ct}\\bm{x}_\\tau = \\bm{0}\\qquad\\text{where}\\qquad\n\\bm{C}_{ct} = \\begin{bmatrix}\n    (\\bm{0}_{(n_a m\\times nk^\\ast)} ~~ \\bm{I}_m \\otimes \\bm{C}_{cs})\\bm{P}' \\\\\n    \\bm{I}_n \\otimes \\bm{C}_{te}\n  \\end{bmatrix}\n$$\n\n* $k^\\ast = \\displaystyle\\sum_{k \\in \\mathcal{K}\\setminus\\{k_1\\}} \\frac{m}{k}$\n* $\\bm{P}=$ the commutation matrix such that $\\bm{P} \\text{vec}(\\bm{Y}_{\\tau}) = \\text{vec}(\\bm{Y}_{\\tau}')$.\n\n# Cross-temporal probabilistic forecast reconciliation\n\n##  Cross-temporal probabilistic forecast reconciliation\n\n\\alert{Nonparametric bootstrap}\\fontsize{14}{16}\\sf\n\n* Simulate future sample paths from all models using bootstrapped residuals, then reconcile them to obtain coherent sample paths.\n* Need to generate samples that preserve cross-temporal relationships.\n* Draw residual samples of all series at same time from most temporally aggregated level.\n* Residuals for other levels obtained using the corresponding time indices.\n\n\n##  Cross-temporal probabilistic forecast reconciliation\n\\vspace*{-0.2cm}\n\n\n::: {.cell hash='fr4_cache/beamer/bootres_72c94ededdcd28557816f3a2db863208'}\n\\hspace*{-0.8cm}\\begin{tikzpicture}[scale = 0.9, every node/.style={scale=0.9}]\n\\matrix (e1) [matrix of nodes,ampersand replacement=\\&,row sep=0cm,column sep=0cm, nodes= {rectangle, fill=white, inner sep = 1pt, font = {\\fontsize{7}{6}\\selectfont}, minimum width=1em, minimum height=1em,anchor=center}, label={[xshift = 0.5em]above:{\\footnotesize$\\widehat{\\textbf{E}}^{[1]}$}}]\n{\n$T$ \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\\\\n$X$ \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\\\\n$Y$ \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\\\\n\\&  1\\&  2\\&  3\\&  4\\&  5\\&  6\\&  7\\&  8\\&  9\\&  10\\&  11\\&  12\\&  13\\&  14\\&  15\\&  16\\\\\n};\n\\draw[decorate,thick, decoration={brace, mirror, amplitude=5pt,raise=-1pt}] (e1-4-2.south west) -- (e1-4-17.south east) node[midway, font = {\\fontsize{7}{6}\\selectfont}, yshift = -1em]{Quarterly, $t = 1,\\dots,16$};\n\\matrix (ek) [above= 10mm of e1.north east, anchor=south east, matrix of nodes,ampersand replacement=\\&,row sep=0cm,column sep=0cm, nodes= {rectangle, fill=white, inner sep = 1pt, font = {\\fontsize{7}{6}\\selectfont}, minimum width=1em, minimum height=1em,anchor=center}, label={[xshift = 0.5em]above:{\\footnotesize$\\widehat{\\textbf{E}}^{[2]}$}}]\n{\n$T$ \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\\\\n$X$ \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\\\\n$Y$ \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\\\\n\\&  1\\&  2\\&  3\\&  4\\&  5\\&  6\\&  7\\&  8\\\\\n};\n\\draw[decorate,thick, decoration={brace, mirror, amplitude=5pt,raise=-1pt}] (ek-4-2.south west) -- (ek-4-9.south east) node[midway, font = {\\fontsize{7}{6}\\selectfont}, yshift = -1em]{Semi-annual, $j = 1,\\dots,8$};\n\\matrix (em) [above= 10mm of e1.north west, anchor=south west, matrix of nodes,ampersand replacement=\\&,row sep=0cm,column sep=0cm, nodes= {rectangle, fill=white, inner sep = 1pt, font = {\\fontsize{7}{6}\\selectfont}, minimum width=1em, minimum height=1em,anchor=center}, label={[xshift = 0.5em]above:{\\footnotesize$\\widehat{\\textbf{E}}^{[4]}$}}]\n{\n$T$ \\& \\pgfuseimage{ngreen}\\& \\pgfuseimage{nblue}\\& \\pgfuseimage{nred}\\& \\pgfuseimage{nblack}\\\\\n$X$ \\& \\pgfuseimage{ngreen}\\& \\pgfuseimage{nblue}\\& \\pgfuseimage{nred}\\& \\pgfuseimage{nblack}\\\\\n$Y$ \\& \\pgfuseimage{ngreen}\\& \\pgfuseimage{nblue}\\& \\pgfuseimage{nred}\\& \\pgfuseimage{nblack}\\\\\n\\&  1\\&  2\\&  3\\&  4\\\\\n};\n\\draw[decorate,thick, decoration={brace, mirror, amplitude=5pt,raise=-1pt}] (em-4-2.south west) -- (em-4-5.south east) node[midway, font = {\\fontsize{7}{6}\\selectfont}, yshift = -1em]{Annual, $\\tau = 1,\\dots,4$};\n\\end{tikzpicture}\n:::\n\n\n\\begin{textblock}{1.9}(12.9,5.3)\n\\begin{block}{}\\centering\n\\textcolor[HTML]{7fb97f}{Year 1}\\\\\n\\textcolor[HTML]{7fbcff}{Year 2}\\\\\n\\textcolor[HTML]{e87f7f}{Year 3}\\\\\n\\textcolor[HTML]{7f7f7f}{Year 4}\n\\end{block}\n\\end{textblock}\n\n\\begin{textblock}{1.9}(12.9,1.6)\n\\begin{minipage}{1.9cm}\n  \\begin{block}{}\\centering\n    \\begin{tikzpicture}\n      \\tikzstyle{every node}=[ellipse,draw,fill=red!15,inner sep=2pt]\n      \\tikzstyle[level distance=.3cm]\n      \\tikzstyle[sibling distance=12cm]\n      \\tikzstyle{level 1}=[sibling distance=10mm,font=\\small,set style={{every node}+=[fill=blue!15]}]\n      \\node{Total}[edge from parent fork down]\n      child {node {X}\n        }\n      child {node {Y}\n        };\n    \\end{tikzpicture}\n  \\end{block}\n\\end{minipage}\n\\end{textblock}\n\n\\begin{textblock}{3}(3.5,1.2)\\alert{Data}\\end{textblock}\n\n\n##  Cross-temporal probabilistic forecast reconciliation\n\\vspace*{-0.2cm}\n\n\n::: {.cell hash='fr4_cache/beamer/bootres1_0d3f9ea55d9bba811115a20261800bf6'}\n\\hspace*{-0.8cm}\\begin{tikzpicture}[scale = 0.9, every node/.style={scale=0.9}]\n\\matrix (e1) [matrix of nodes,ampersand replacement=\\&,row sep=0cm,column sep=0cm, nodes= {rectangle, fill=white, inner sep = 1pt, font = {\\fontsize{7}{6}\\selectfont}, minimum width=1em, minimum height=1em,anchor=center}, label={[xshift = 0.5em]above:{\\footnotesize$\\widehat{\\textbf{E}}^{[1]}$}}]\n{\n$T$ \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\\\\n$X$ \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\\\\n$Y$ \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\\\\n\\&  1\\&  2\\&  3\\&  4\\&  5\\&  6\\&  7\\&  8\\&  9\\&  10\\&  11\\&  12\\&  13\\&  14\\&  15\\&  16\\\\\n};\n\\draw[decorate,thick, decoration={brace, mirror, amplitude=5pt,raise=-1pt}] (e1-4-2.south west) -- (e1-4-17.south east) node[midway, font = {\\fontsize{7}{6}\\selectfont}, yshift = -1em]{Quarterly, $t = 1,\\dots,16$};\n\\matrix (ek) [above= 10mm of e1.north east, anchor=south east, matrix of nodes,ampersand replacement=\\&,row sep=0cm,column sep=0cm, nodes= {rectangle, fill=white, inner sep = 1pt, font = {\\fontsize{7}{6}\\selectfont}, minimum width=1em, minimum height=1em,anchor=center}, label={[xshift = 0.5em]above:{\\footnotesize$\\widehat{\\textbf{E}}^{[2]}$}}]\n{\n$T$ \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\\\\n$X$ \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\\\\n$Y$ \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{nblack} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\\\\n\\&  1\\&  2\\&  3\\&  4\\&  5\\&  6\\&  7\\&  8\\\\\n};\n\\draw[decorate,thick, decoration={brace, mirror, amplitude=5pt,raise=-1pt}] (ek-4-2.south west) -- (ek-4-9.south east) node[midway, font = {\\fontsize{7}{6}\\selectfont}, yshift = -1em]{Semi-annual, $j = 1,\\dots,8$};\n\\matrix (em) [above= 10mm of e1.north west, anchor=south west, matrix of nodes,ampersand replacement=\\&,row sep=0cm,column sep=0cm, nodes= {rectangle, fill=white, inner sep = 1pt, font = {\\fontsize{7}{6}\\selectfont}, minimum width=1em, minimum height=1em,anchor=center}, label={[xshift = 0.5em]above:{\\footnotesize$\\widehat{\\textbf{E}}^{[4]}$}}]\n{\n$T$ \\& \\pgfuseimage{nred}\\& \\pgfuseimage{nblack}\\& \\pgfuseimage{ngreen}\\& \\pgfuseimage{nblue}\\\\\n$X$ \\& \\pgfuseimage{nred}\\& \\pgfuseimage{nblack}\\& \\pgfuseimage{ngreen}\\& \\pgfuseimage{nblue}\\\\\n$Y$ \\& \\pgfuseimage{nred}\\& \\pgfuseimage{nblack}\\& \\pgfuseimage{ngreen}\\& \\pgfuseimage{nblue}\\\\\n\\&  1\\&  2\\&  3\\&  4\\\\\n};\n\\draw[decorate,thick, decoration={brace, mirror, amplitude=5pt,raise=-1pt}] (em-4-2.south west) -- (em-4-5.south east) node[midway, font = {\\fontsize{7}{6}\\selectfont}, yshift = -1em]{Annual, $\\tau = 1,\\dots,4$};\n\\end{tikzpicture}\n:::\n\n\n\\begin{textblock}{1.9}(12.9,5.3)\n\\begin{block}{}\\centering\n\\textcolor[HTML]{7fb97f}{Year 1}\\\\\n\\textcolor[HTML]{7fbcff}{Year 2}\\\\\n\\textcolor[HTML]{e87f7f}{Year 3}\\\\\n\\textcolor[HTML]{7f7f7f}{Year 4}\n\\end{block}\n\\end{textblock}\n\n\\begin{textblock}{1.9}(12.9,1.6)\n\\begin{minipage}{1.9cm}\n  \\begin{block}{}\\centering\n    \\begin{tikzpicture}\n      \\tikzstyle{every node}=[ellipse,draw,fill=red!15,inner sep=2pt]\n      \\tikzstyle[level distance=.3cm]\n      \\tikzstyle[sibling distance=12cm]\n      \\tikzstyle{level 1}=[sibling distance=10mm,font=\\small,set style={{every node}+=[fill=blue!15]}]\n      \\node{Total}[edge from parent fork down]\n      child {node {X}\n        }\n      child {node {Y}\n        };\n    \\end{tikzpicture}\n  \\end{block}\n\\end{minipage}\n\\end{textblock}\n\n\\begin{textblock}{3}(3.5,1.2)\\alert{Bootstrap}\\end{textblock}\n\n##  Cross-temporal probabilistic forecast reconciliation\n\\vspace*{-0.2cm}\n\n\n::: {.cell hash='fr4_cache/beamer/bootres2_9f337e8998dd4bf348981b949d175d9a'}\n\\hspace*{-0.8cm}\\begin{tikzpicture}[scale = 0.9, every node/.style={scale=0.9}]\n\\matrix (e1) [matrix of nodes,ampersand replacement=\\&,row sep=0cm,column sep=0cm, nodes= {rectangle, fill=white, inner sep = 1pt, font = {\\fontsize{7}{6}\\selectfont}, minimum width=1em, minimum height=1em,anchor=center}, label={[xshift = 0.5em]above:{\\footnotesize$\\widehat{\\textbf{E}}^{[1]}$}}]\n{\n$T$ \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\\\\n$X$ \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\\\\n$Y$ \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\\\\n\\&  1\\&  2\\&  3\\&  4\\&  5\\&  6\\&  7\\&  8\\&  9\\&  10\\&  11\\&  12\\&  13\\&  14\\&  15\\&  16\\\\\n};\n\\draw[decorate,thick, decoration={brace, mirror, amplitude=5pt,raise=-1pt}] (e1-4-2.south west) -- (e1-4-17.south east) node[midway, font = {\\fontsize{7}{6}\\selectfont}, yshift = -1em]{Quarterly, $t = 1,\\dots,16$};\n\\matrix (ek) [above= 10mm of e1.north east, anchor=south east, matrix of nodes,ampersand replacement=\\&,row sep=0cm,column sep=0cm, nodes= {rectangle, fill=white, inner sep = 1pt, font = {\\fontsize{7}{6}\\selectfont}, minimum width=1em, minimum height=1em,anchor=center}, label={[xshift = 0.5em]above:{\\footnotesize$\\widehat{\\textbf{E}}^{[2]}$}}]\n{\n$T$ \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\\\\n$X$ \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\\\\n$Y$ \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nred} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{ngreen} \\& \\pgfuseimage{nblue} \\& \\pgfuseimage{nblue} \\& \\\\\n\\&  1\\&  2\\&  3\\&  4\\&  5\\&  6\\&  7\\&  8\\\\\n};\n\\draw[decorate,thick, decoration={brace, mirror, amplitude=5pt,raise=-1pt}] (ek-4-2.south west) -- (ek-4-9.south east) node[midway, font = {\\fontsize{7}{6}\\selectfont}, yshift = -1em]{Semi-annual, $j = 1,\\dots,8$};\n\\matrix (em) [above= 10mm of e1.north west, anchor=south west, matrix of nodes,ampersand replacement=\\&,row sep=0cm,column sep=0cm, nodes= {rectangle, fill=white, inner sep = 1pt, font = {\\fontsize{7}{6}\\selectfont}, minimum width=1em, minimum height=1em,anchor=center}, label={[xshift = 0.5em]above:{\\footnotesize$\\widehat{\\textbf{E}}^{[4]}$}}]\n{\n$T$ \\& \\pgfuseimage{nred}\\& \\pgfuseimage{nblue}\\pgfuseimage{ngreen}\\& \\pgfuseimage{nblue}\\\\\n$X$ \\& \\pgfuseimage{nred}\\& \\pgfuseimage{nblue}\\pgfuseimage{ngreen}\\& \\pgfuseimage{nblue}\\\\\n$Y$ \\& \\pgfuseimage{nred}\\& \\pgfuseimage{nblue}\\pgfuseimage{ngreen}\\& \\pgfuseimage{nblue}\\\\\n\\&  1\\&  2\\&  3\\&  4\\\\\n};\n\\draw[decorate,thick, decoration={brace, mirror, amplitude=5pt,raise=-1pt}] (em-4-2.south west) -- (em-4-5.south east) node[midway, font = {\\fontsize{7}{6}\\selectfont}, yshift = -1em]{Annual, $\\tau = 1,\\dots,4$};\n\\end{tikzpicture}\n:::\n\n\n\\begin{textblock}{1.9}(12.9,5.3)\n\\begin{block}{}\\centering\n\\textcolor[HTML]{7fb97f}{Year 1}\\\\\n\\textcolor[HTML]{7fbcff}{Year 2}\\\\\n\\textcolor[HTML]{e87f7f}{Year 3}\\\\\n\\textcolor[HTML]{7f7f7f}{Year 4}\n\\end{block}\n\\end{textblock}\n\n\\begin{textblock}{1.9}(12.9,1.6)\n\\begin{minipage}{1.9cm}\n  \\begin{block}{}\\centering\n    \\begin{tikzpicture}\n      \\tikzstyle{every node}=[ellipse,draw,fill=red!15,inner sep=2pt]\n      \\tikzstyle[level distance=.3cm]\n      \\tikzstyle[sibling distance=12cm]\n      \\tikzstyle{level 1}=[sibling distance=10mm,font=\\small,set style={{every node}+=[fill=blue!15]}]\n      \\node{Total}[edge from parent fork down]\n      child {node {X}\n        }\n      child {node {Y}\n        };\n    \\end{tikzpicture}\n  \\end{block}\n\\end{minipage}\n\\end{textblock}\n\n\\begin{textblock}{3}(3.5,1.2)\\alert{Bootstrap}\\end{textblock}\n\n\\only<2>{\\begin{textblock}{8}(3.7,4)\n\\begin{alertblock}{}\nThe ``year'' can start in any quarter, giving overlapping blocks.\n\\end{alertblock}\n\\end{textblock}}\n\n# Cross-temporal probabilistic reconciliation: Examples\n\n## Quarterly Australian GDP data\n\n\\only<1>{\\full{IncomeApproach}}\n\\only<2>{\\full{ExpenditureApproach}}\n\\only<3>{\\full{GFCF}}\n\\only<4>{\\full{HFCE}}\n\n## Quarterly Australian GDP data\n\n* Quarterly data: 1984:Q4 -- 2018:Q1\n* 95 series\n* Time series cross-validation;  initial training set of 10 years.\n* One-quarter increase in each training set\n* For each training set, compute temporally aggregated series for $k \\in \\{1,2,4\\}$, and produce forecasts up to $h_1=4$, $h_2=2$, and $h_{4}=1$ steps ahead.\n\n* Automatic ARIMA forecasts for all series.\n\n## Quarterly Australian GDP data --- CRPS skill scores\n\\alert{Reconciliation approaches}\\fontsize{13}{14}\\sf\n\n* Cross-temporal \\textbf{\\color{newblue}{bottom-up}} and \\textbf{\\color{newblue}{partly bottom-up}}\n\n  \\begin{tabular}{M{0.24\\linewidth}|M{0.24\\linewidth}|M{0.24\\linewidth}}\n  ct$(shr_{cs}, bu_{te})$ & ct$(wlsv_{te}, bu_{cs})$\n  \\end{tabular}\n\n* Optimal forecast reconciliation with \\textbf{\\color{newblue}{overlapping one-step residuals}}\n\n  \\begin{tabular}{M{0.24\\linewidth}|M{0.24\\linewidth}|M{0.24\\linewidth}|M{0.24\\linewidth}}\n  oct$_o(wlsv)$ & oct$_o(bdshr)$\n  \\end{tabular}\n\n* Optimal forecast reconciliation with \\textbf{\\color{newblue}{overlapping and multi-step residuals}}\n\n  \\begin{tabular}{M{0.24\\linewidth}|M{0.24\\linewidth}|M{0.24\\linewidth}|M{0.24\\linewidth}}\n  oct$_{oh}(hshr)$ & oct$_{oh}(shr)$\n  \\end{tabular}\n\n## Quarterly Australian GDP data --- CRPS skill scores\n\n\\centerline{\\textcolor{red}{Worse than benchmark}\\qquad \\textbf{Best}}\\vspace*{-0.3cm}\n\n\\centering\n\\input{tab/AusGDP/sam_crps.tex}\n\n## Quarterly Australian GDP data: Nemenyi test\n\n\\placefig{0.5}{1}{width=6.1cm, height = 20cm, trim = 0 300 0 20, clip=true}{figs/AusGDP/ctjb.pdf}\n\\placefig{8.5}{1.1}{width=6.1cm, height = 20cm, trim = 0 0 0 370, clip=true}{figs/AusGDP/ctjb.pdf}\n\n\\only<2>{\\begin{textblock}{4}(11.7,2.3)\\begin{block}{}\n\\fontsize{11}{12}\\sf\n\\begin{itemize}\\tightlist\n\\item Mean ranks shown\n\\item Sig diff if non-overlapping intervals\n\\end{itemize}\n\\end{block}\\end{textblock}}\n\n\n## Monthly Australian Tourism Demand\n\n\\begin{textblock}{6}(0.2,1.2)\n\\centering\\fontsize{12}{13}\\sf\n\\textbf{Geographical division}\\\\\n\\includegraphics[width = 5.8cm]{figs/ausreg2.pdf}\\\\\n\\faTimes\\\\\n\\textbf{Purpose of travel}\\\\\n{\\fontsize{11}{12}\\sf Holiday, Visiting friends \\& relatives, Business, Other}\n\\end{textblock}\n\n\\begin{textblock}{10}(6.1,1)\n\\fontsize{11}{14}\\sf\n\\begin{itemize}\n\\item \\textbf{Grouped ts}\\newline (geographical divisions $\\times$ purpose of travel)\n\n\\begin{tabular}{cccccc}\n\\toprule\n  & \\textbf{AUS} & \\textbf{States} & \\textbf{Zones$^\\ast$} & \\textbf{Regions} & \\textbf{Tot}\\\\\n  \\midrule\n  \\textbf{g.d.} & {\\color{newblue}1} & {\\color{newblue}7} & {\\color{newblue}21} & {\\color{newblue}76} & 105 \\\\\n  \\textbf{p.o.t.} & {\\color{newblue}4} & {\\color{newblue}28} & {\\color{newblue}84} & {\\color{avocado}304} & 420\\\\\n  \\midrule\n  \\textbf{Tot} & 5 & 35 & 105 & 380 & \\textbf{525}\\\\\n  \\bottomrule\n\\end{tabular}\n\\centerline{{\\color{newblue}$n_a = 221$}, {\\color{avocado}$n_b = 304$}, and $\\textbf{n = 525}$}\n\n\\item \\textbf{Temporal framework}, frequencies:\\\\[0.2cm]\n\\begin{multicols}{2}\n  \\begin{itemize}\\tightlist\n  \\item Monthly\n  \\item Bi-Monthly\n  \\item Quarterly\n  \\end{itemize}\n  \\begin{itemize}\\tightlist\n  \\item Four-Monthly\n  \\item Semi-Annual\n  \\item Annual\n  \\end{itemize}\n\\end{multicols}\n\\end{itemize}\n\\end{textblock}\n\n## Example: Monthly Australian Tourism Demand\n\n* Monthly data: January 1998 to December 2016\n\n* Time series cross-validation; initial training set 10 years.\n\n* One-month increase in each training set\n\n* For each training set, compute temporally aggregated series for $k \\in \\{1,2,3,4,6,12\\}$, and produce forecasts up to $h_2=6$, $h_3=4$, $h_4=3$, $h_6=2$ and $h_{12}=1$ steps ahead.\n\n* Automatic ETS forecasts on log-transformed data\n\n## Example: Australian GDP data --- CRPS skill scores\n\\alert{Reconciliation approaches}\\fontsize{13}{14}\\sf\n\n* Cross-temporal \\textbf{\\color{newblue}{bottom-up}} and \\textbf{\\color{newblue}{partly bottom-up}}\n\n  \\begin{tabular}{M{0.24\\linewidth}|M{0.24\\linewidth}|M{0.24\\linewidth}}\n  ct$(bu)$ & ct$(shr_{cs}, bu_{te})$ & ct$(wlsv_{te}, bu_{cs})$\n  \\end{tabular}\n\n* Optimal forecast reconciliation with \\textbf{\\color{newblue}{one-step residuals}}\n\n    \\begin{tabular}{M{0.24\\linewidth}|M{0.24\\linewidth}|M{0.24\\linewidth}|M{0.24\\linewidth}}\n    oct$(ols)$ & oct$(struc)$ & oct$(wlsv)$ & oct$(bdshr)$\n    \\end{tabular}\n\n* Optimal forecast reconciliation with \\textbf{\\color{newblue}{multi-step residuals}}\n\n    \\begin{tabular}{M{0.24\\linewidth}|M{0.24\\linewidth}|M{0.24\\linewidth}|M{0.24\\linewidth}}\n    oct$_h(hbshr)$ & oct$_h(bshr)$ & oct$_h(hshr)$ & oct$_h(shr)$\n    \\end{tabular}\n\n## Example: Australian tourism data -- CRPS skill scores\n\\fontsize{12}{13}\\sf\\vspace*{0.2cm}\n\n\\centerline{\\textcolor{red}{Worse than benchmark}\\qquad \\textbf{Best}}\n\n\\centering\n\\footnotesize\n\\begin{tabular}[t]{lrr}\n& \\textbf{$\\forall k \\in \\{12,6,4,3,2,1\\}$} & \\textbf{$k = 1$}\\\\\n\\midrule\nbase                      & \\cellcolor{LightOrange!30} {1.000}  & \\cellcolor{LightOrange!30} {1.000} \\\\\nct$(bu)$                  & \\textcolor{red}{1.321}              & \\textcolor{red}{1.077} \\\\\nct$(shr_{cs}, bu_{te})$   & \\textcolor{red}{1.057}              & {0.976} \\\\\nct$(wlsv_{te}, bu_{cs})$  & \\textcolor{red}{1.062}              & {0.976}\\\\\noct$(ols)$                & {0.989}                             & {0.982}\\\\\noct$(struc)$              & {0.982}                             & {0.970}\\\\\noct$(wlsv)$               & {0.987}                             & {0.952} \\\\\noct$(bdshr)$              & {0.975}                             & {\\textbf{0.949}} \\\\\noct$_h(hbshr)$            & {0.989}                             & {0.982} \\\\\noct$_h(bshr)$             & {0.994}                             & {0.988}\\\\\noct$_h(hshr)$             & {\\textbf{0.969}}                    & {0.953}\\\\\noct$_h(shr)$              & \\textcolor{red}{1.007}              & \\textcolor{red}{1.000}\n\\end{tabular}\n\n## MCB Nemenyi test\n\n\\placefig{0}{1.2}{width=16cm, height=200cm, trim = 0 520 0 30, clip=TRUE}{figs/VN525/ctjb_more.pdf}\n\n\\begin{textblock}{15}(0.2,7)\n\\begin{itemize}\\tightlist\n\\item mean ranks shown\n\\item significant differences if non-overlapping intervals\n\\end{itemize}\n\\end{textblock}\n\n# Software\n\n## Software\n\\fontsize{11}{12}\\sf\\vspace*{0.3cm}\n\n\\hspace*{-0.6cm}\\begin{tabular}{llP{1.7cm}cP{1.7cm}c}\n\\toprule\nPackage                                                                      & Language  & Cross-sectional  & Temporal    & Cross-temporal  & Probabilistic\\\\\n\\midrule\n\\texttt{\\href{https://pkg.earo.me/hts/}{hts}}\n    & R         & \\checkmark       &             &                 & \\\\\n\\texttt{\\href{http://pkg.robjhyndman.com/thief/}{thief}}\n    & R         &                  & \\checkmark  &                 & \\\\\n\\texttt{\\href{https://fable.tidyverts.org}{fable}}\n    & R         & \\checkmark       &             &                 & \\checkmark\\\\\n\\texttt{\\href{https://danigiro.github.io/FoReco/}{FoReco}}\n    & R         & \\checkmark       & \\checkmark  & \\checkmark      & \\checkmark\\\\\n\\texttt{\\href{https://angelpone.github.io/pyhts/}{pyhts}}\n    & Python    & \\checkmark       & \\checkmark  &                 & \\\\\n\\texttt{\\href{https://nixtla.github.io/hierarchicalforecast/}{hierarchicalforecast}}\n    & Python    & \\checkmark       &             &                 & \\checkmark \\\\\n\\bottomrule\n\\end{tabular}\n\n* `hts`, `thief`, and `FoReco` use `ts` objects\n* `fable` uses `tsibble` objects\n* `fable` has plans to implement temporal and cross-temporal reconciliation\n\n## Thanks!\n\n\\placefig{0}{1.2}{trim = 10 45 0 0, clip=TRUE, width=10cm, height=2.5cm}{roman}\n\\placefig{2}{1.2}{trim = 0 40 0 0, clip=TRUE, width=10cm, height=2.5cm}{george}\n\\placefig{4}{1.2}{trim = 0 10 0 0, clip=TRUE, width=10cm, height=2.5cm}{hanlin}\n\\placefig{6}{1.2}{trim = 10 0 0 0, clip=TRUE, width=10cm, height=2.5cm}{earowang}\n\\placefig{8}{1.2}{trim = 0 15 0 0, clip=TRUE, width=10cm, height=2.5cm}{alanlee}\n\\placefig{10}{1.2}{trim = 30 0 0 0, clip=TRUE, width=10cm, height=2.5cm}{mitch}\n\\placefig{12}{1.2}{trim = 15 0 0 0, clip=TRUE, width=10cm, height=2.5cm}{shanika}\n\\placefig{14}{1.2}{trim = 40 0 0 0, clip=TRUE, width=10cm, height=2.5cm}{tas}\n\n\\placefig{0}{3.8}{trim = 30 10 30 0, clip=TRUE, width=10cm, height=2.5cm}{puwasala}\n\\placefig{2}{3.8}{trim = 0 10 0 0, clip=TRUE, width=10cm, height=2.5cm}{fotios}\n\\placefig{4}{3.8}{trim = 100 30 50 20, clip=TRUE, width=10cm, height=2.5cm}{nikos}\n\\placefig{6}{3.8}{trim = 50 30 0 0, clip=TRUE, width=10cm, height=2.5cm}{souhaib}\n\\placefig{8}{3.8}{trim = 110 40 50 0, clip=TRUE, width=10cm, height=2.5cm}{james}\n\\placefig{10}{3.8}{trim = 40 40 0 0, clip=TRUE, width=10cm, height=2.5cm}{mahdi}\n\\placefig{12}{3.8}{trim = 50 50 0 0, clip=TRUE, width=10cm, height=2.5cm}{christoph}\n\\placefig{14}{3.8}{trim = 50 50 0 20, clip=TRUE, width=10cm, height=2.5cm}{fin}\n\n\\placefig{0}{6.4}{trim = 10 0 0 0, clip=TRUE, width=10cm, height=2.5cm}{berwin}\n\\placefig{2}{6.4}{trim = 10 20 0 0, clip=TRUE, width=10cm, height=2.5cm}{galit}\n\\placefig{4}{6.4}{trim = 10 0 0 0, clip=TRUE, width=10cm, height=2.5cm}{mahsa}\n\\placefig{6}{6.4}{trim = 30 0 0 0, clip=TRUE, width=10cm, height=2.5cm}{evan}\n\\placefig{8}{6.4}{trim = 5 25 0 0, clip=TRUE, width=10cm, height=2.5cm}{bahman}\n\\placefig{10}{6.4}{trim = 0 40 0 0, clip=TRUE, width=10cm, height=2.5cm}{pablo}\n\\placefig{12}{6.4}{trim = 0 40 0 0, clip=TRUE, width=10cm, height=2.5cm}{danielegiro}\n\\placefig{14}{6.4}{trim = 0 0 0 30, clip=TRUE, width=10cm, height=2.5cm}{tommy}\n\n## More information\n\\fontsize{18}{20}\\sf\n\n\\href{https://robjhyndman.com/fr2023}{\\includegraphics[width=0.5cm]{figs/slide}\\, robjhyndman.com/fr2023}\n\n\\href{https://robjhyndman.com}{\\faicon{home} robjhyndman.com}\n\n\\href{https://twitter.com/robjhyndman}{\\faicon{twitter} @robjhyndman}\n\n\\href{https://aus.social/@robjhyndman}{\\includegraphics[width=0.5cm]{figs/mastodon}\\, aus.social/@robjhyndman}\n\n\\href{https://github.com/robjhyndman}{\\faicon{github}  @robjhyndman}\n\n\\href{mailto:rob.hyndman@monash.edu}{\\faicon{envelope}  rob.hyndman@monash.edu}\n\n\\begin{textblock}{6.2}(0,8.8)\\pgfsetfillopacity{0.65}\n\\begin{beamercolorbox}[wd=4.7cm]{block body}\n\\fontsize{6}{6}\\sf\\color[RGB]{72,45,34}\\href{https://www.flaticon.com/free-icons/presentation}{Presentation icon created by orvipixel - Flaticon}\n  \\end{beamercolorbox}\n\\end{textblock}\n\n\n\\nocite{Di_FonGir2022a,temporal-hierarchies,ctprob}\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}